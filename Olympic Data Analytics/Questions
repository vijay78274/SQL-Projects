Dataset link : https://techtfq.com/blog/practice-writing-sql-queries-using-real-dataset#google_vignette=

Q1. How many olympics games have been held?
select count(distinct(games)) as total_games from athlete_events;

Q2. List down all Olympics games held so far.
select distinct(games) from athlete_events;

Q3. Mention the total no of nations who participated in each olympics game?
select games, count(noc) as total_nations from athlete_events group by games;

Q4. Which year saw the highest and lowest no of countries participating in olympics?
with 
high as 
(
	select year, count(noc)  as highest from athlete_events group by year order by count(noc) desc limit 1
),
low as 
(
	select year, count(noc) as lowest from athlete_events group by year order by count(noc) asc limit 1
) 
select high.year, high.highest from high union select low.year, low.lowest from low;

Q5. Which nation has participated in all of the olympic games?
select noc, count(year) from athlete_events group by noc having count(distinct year) = (select count( distinct year) from athlete_events);

Q6. Identify the sport which was played in all summer olympics.
select sport, sum(case when season='summer' then 1 else 0 end) as total_summer from athlete_events 
group by sport
having 
sum(case when season='summer' then 1 else 0 end) = (select sum(case when season='summer' then 1 else 0 end) from athlete_events);

Q7. Which Sports were just played only once in the olympics?
select sport, count(Games) as only_played_once from athlete_events group by sport having count(Games)=1; 

Q8. Fetch the total no of sports played in each olympic games.
select Games, count(sport) as total_sports from athlete_events group by Games; 

Q9. Fetch details of the oldest athletes to win a gold medal.
select name, sex, age, height, weight from athlete_events where age = (select max(age) from athlete_events) and medal='Gold';
